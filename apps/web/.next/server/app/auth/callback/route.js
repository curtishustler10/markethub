"use strict";(()=>{var e={};e.id=936,e.ids=[936],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},38630:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>g,patchFetch:()=>h,requestAsyncStorage:()=>d,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>x});var a={};t.r(a),t.d(a,{GET:()=>c});var s=t(49303),o=t(88716),n=t(60670),i=t(19692),u=t(87070),l=t(90455);async function c(e){let{searchParams:r,origin:t}=new URL(e.url),a=r.get("code"),s=r.get("next")??"/";if(a){let e=(0,i.e)(),{data:r,error:o}=await e.auth.exchangeCodeForSession(a);if(!o&&r.user){let{data:a}=await e.from("profiles").select("id").eq("id",r.user.id).single();if(!a){let e=r.user.user_metadata||{};try{await (0,l.xv)(r.user.id,r.user.email,e.name||r.user.email.split("@")[0],e.role||"vendor")}catch(e){console.error("Error creating profile:",e)}}let{data:o}=await e.from("profiles").select("role").eq("id",r.user.id).single();if(o){let e=s;return("/"===s||"/auth/login"===s)&&(e="market_organizer"===o.role||"admin"===o.role?"/organizer/dashboard":"/vendor/browse"),u.NextResponse.redirect(`${t}${e}`)}}}return u.NextResponse.redirect(`${t}/auth/auth-code-error`)}let p=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/auth/callback/route",pathname:"/auth/callback",filename:"route",bundlePath:"app/auth/callback/route"},resolvedPagePath:"/Users/gwendolyn/Downloads/markethub/apps/web/app/auth/callback/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:d,staticGenerationAsyncStorage:x,serverHooks:m}=p,g="/auth/callback/route";function h(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:x})}},90455:(e,r,t)=>{t.d(r,{JQ:()=>s,xv:()=>o});var a=t(19692);async function s(){let e=(0,a.e)(),{data:{user:r}}=await e.auth.getUser();if(!r)return null;let{data:t}=await e.from("profiles").select("*").eq("id",r.id).single();return t}async function o(e,r,t,s){let o=(0,a.e)(),{data:n,error:i}=await o.from("profiles").insert({id:e,email:r,name:t,role:s}).select().single();if(i)throw i;return n}},19692:(e,r,t)=>{t.d(r,{e:()=>o,m:()=>n});var a=t(83066),s=t(71615);function o(){let e=(0,s.cookies)();return(0,a.lx)(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,{cookies:{get:r=>e.get(r)?.value,set(r,t,a){e.set({name:r,value:t,...a})},remove(r,t){e.set({name:r,value:"",...t})}}})}function n(){return(0,a.lx)(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.SUPABASE_SERVICE_ROLE_KEY,{cookies:{get(){},set(){},remove(){}}})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[948,265,775,70],()=>t(38630));module.exports=a})();