(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[993],{4190:function(e,t,a){Promise.resolve().then(a.bind(a,807))},807:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return et}});var s=a(7573),r=a(7653),i=a(7754),n=a(7659),l=a(3187),o=a(3608),c=a(6898),d=a(2988),m=a(5191),u=a(1138),x=a(9135),h=a(2875),g=a(5974),p=a(5432),v=a(9869),f=a(5983),y=a(1490),j=a(1259),b=a(7904),N=a(9140),w=a(9125),_=a(2234),k=a(7658),S=a(2302),D=a(874),C=a(8577),E=a(3972),z=a(1804);function A(e){let{viewMode:t,selectedDate:a,events:i,onEventClick:n,onDateClick:l,onDateChange:o}=e,[c,d]=(0,r.useState)(null),m=(0,r.useMemo)(()=>i.map(e=>({...e,start_at_local:new Date(e.start_at).toLocaleString("en-AU",{timeZone:"Australia/Brisbane"}),end_at_local:new Date(e.end_at).toLocaleString("en-AU",{timeZone:"Australia/Brisbane"}),start_date:(0,p.D)(e.start_at),end_date:(0,p.D)(e.end_at)})),[i]),u=e=>m.filter(t=>{let a=(0,v.b)(t.start_date),s=(0,f.i)(t.end_date),r=(0,v.b)(e);return a<=(0,f.i)(e)&&s>=r}),x=(0,r.useMemo)(()=>{if("month"!==t)return[];let e=(0,y.z)((0,j.N)(a)),s=(0,b.v)((0,N.V)(a));return(0,w.D)({start:e,end:s})},[a,t]),h=(0,r.useMemo)(()=>"day"!==t?[]:Array.from({length:24},(e,t)=>t),[t]),A=e=>new Date(e).toLocaleTimeString("en-AU",{timeZone:"Australia/Brisbane",hour:"numeric",minute:"2-digit",hour12:!0});if("month"===t)return(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("div",{className:"grid grid-cols-7 gap-1 mb-4",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,s.jsx)("div",{className:"p-2 text-center text-sm font-medium text-gray-500",children:e},e))}),(0,s.jsx)("div",{className:"grid grid-cols-7 gap-1",children:x.map(e=>{let t=u(e),r=(0,_.x)(e,a),i=(0,k.z)(e),c=(0,S.K)(e,a);return(0,s.jsxs)("div",{className:(0,g.cn)("min-h-[120px] p-2 border border-gray-100 cursor-pointer transition-colors",r?"bg-white hover:bg-gray-50":"bg-gray-50 text-gray-400",i&&"bg-blue-50 border-blue-200",c&&"ring-2 ring-blue-500"),onClick:()=>{o(e),l(e)},onMouseEnter:()=>d(e),onMouseLeave:()=>d(null),children:[(0,s.jsx)("div",{className:(0,g.cn)("text-sm font-medium mb-1",i&&"text-blue-600"),children:(0,D.WU)(e,"d")}),(0,s.jsxs)("div",{className:"space-y-1",children:[t.slice(0,3).map((e,t)=>(0,s.jsxs)("div",{className:(0,g.cn)("text-xs p-1 rounded cursor-pointer transition-colors","private"===e.visibility?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-blue-100 text-blue-800 hover:bg-blue-200"),onClick:t=>{t.stopPropagation(),n(e)},children:[(0,s.jsx)("div",{className:"font-medium truncate",children:e.title}),!e.all_day&&(0,s.jsx)("div",{className:"text-xs opacity-75",children:A(e.start_at)})]},e.id)),t.length>3&&(0,s.jsxs)("div",{className:"text-xs text-gray-500 font-medium",children:["+",t.length-3," more"]})]})]},e.toISOString())})}),0===i.length&&(0,s.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,s.jsx)(C.Z,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),(0,s.jsx)("h3",{className:"font-medium mb-2",children:"No events this month"}),(0,s.jsx)("p",{className:"text-sm",children:"Click on any date to create your first event"})]})]});if("week"===t){let e=(0,y.z)(a),t=(0,w.D)({start:e,end:(0,b.v)(a)});return(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-8 gap-1 mb-4",children:[(0,s.jsx)("div",{className:"p-2"})," ",t.map(e=>(0,s.jsxs)("div",{className:"p-2 text-center",children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:(0,D.WU)(e,"EEE")}),(0,s.jsx)("div",{className:(0,g.cn)("text-lg font-semibold",(0,k.z)(e)&&"text-blue-600"),children:(0,D.WU)(e,"d")})]},e.toISOString()))]}),(0,s.jsxs)("div",{className:"grid grid-cols-8 gap-1",children:[(0,s.jsx)("div",{className:"space-y-16",children:Array.from({length:12},(e,t)=>t+6).map(e=>(0,s.jsx)("div",{className:"text-sm text-gray-500 text-right pr-2",children:12===e?"12 PM":e>12?"".concat(e-12," PM"):"".concat(e," AM")},e))}),t.map(e=>{let t=u(e);return(0,s.jsx)("div",{className:"border-l border-gray-100 min-h-[600px] relative cursor-pointer hover:bg-gray-50",onClick:()=>l(e),children:t.map(e=>(0,s.jsxs)("div",{className:(0,g.cn)("absolute left-1 right-1 p-1 rounded text-xs cursor-pointer","private"===e.visibility?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-blue-100 text-blue-800 hover:bg-blue-200"),style:{top:"".concat((new Date(e.start_at).getHours()-6)*64,"px"),height:"".concat(Math.max(32,(new Date(e.end_at).getTime()-new Date(e.start_at).getTime())/36e5*64),"px")},onClick:t=>{t.stopPropagation(),n(e)},children:[(0,s.jsx)("div",{className:"font-medium truncate",children:e.title}),(0,s.jsxs)("div",{className:"text-xs opacity-75",children:[A(e.start_at)," - ",A(e.end_at)]})]},e.id))},e.toISOString())})]})]})}if("day"===t){let e=u(a);return(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("div",{className:"mb-6 text-center",children:(0,s.jsx)("h2",{className:"text-xl font-semibold",children:(0,D.WU)(a,"EEEE, MMMM d, yyyy")})}),(0,s.jsxs)("div",{className:"flex gap-6",children:[(0,s.jsx)("div",{className:"w-24",children:h.map(e=>(0,s.jsx)("div",{className:"h-16 flex items-start pt-2",children:(0,s.jsx)("span",{className:"text-sm text-gray-500",children:0===e?"12 AM":12===e?"12 PM":e>12?"".concat(e-12," PM"):"".concat(e," AM")})},e))}),(0,s.jsxs)("div",{className:"flex-1 relative border-l border-gray-100",children:[h.map(e=>(0,s.jsx)("div",{className:"h-16 border-b border-gray-100"},e)),e.map(e=>{let t=new Date(e.start_at).getHours(),a=new Date(e.start_at).getMinutes(),r=(new Date(e.end_at).getTime()-new Date(e.start_at).getTime())/6e4;return(0,s.jsxs)("div",{className:(0,g.cn)("absolute left-2 right-2 p-2 rounded cursor-pointer","private"===e.visibility?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-blue-100 text-blue-800 hover:bg-blue-200"),style:{top:"".concat(64*t+a/60*64,"px"),height:"".concat(Math.max(32,r/60*64),"px")},onClick:()=>n(e),children:[(0,s.jsx)("div",{className:"font-medium",children:e.title}),(0,s.jsxs)("div",{className:"text-sm opacity-75",children:[A(e.start_at)," - ",A(e.end_at)]}),e.location&&(0,s.jsxs)("div",{className:"text-xs mt-1 flex items-center",children:[(0,s.jsx)(E.Z,{className:"w-3 h-3 mr-1"}),e.location]})]},e.id)}),0===e.length&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(z.Z,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),(0,s.jsx)("h3",{className:"font-medium mb-2",children:"No events today"}),(0,s.jsx)("p",{className:"text-sm",children:"Click anywhere to create an event"})]})})]})]})]})}return null}var M=a(1998),Z=a(132),T=a(5809),P=a(4051),F=a(1737),O=a(5517),U=a(5623);let I=F.fC;F.xz,F.x8;let H=F.h_,B=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(F.aV,{className:(0,g.cn)("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r,ref:t})});B.displayName=F.aV.displayName;let L=(0,O.j)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),V=r.forwardRef((e,t)=>{let{side:a="right",className:r,children:i,...n}=e;return(0,s.jsxs)(H,{children:[(0,s.jsx)(B,{}),(0,s.jsxs)(F.VY,{ref:t,className:(0,g.cn)(L({side:a}),r),...n,children:[i,(0,s.jsxs)(F.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,s.jsx)(U.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});V.displayName=F.VY.displayName;let R=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,g.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};R.displayName="SheetHeader";let Y=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,g.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};Y.displayName="SheetFooter";let W=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(F.Dx,{ref:t,className:(0,g.cn)("text-lg font-semibold text-foreground",a),...r})});W.displayName=F.Dx.displayName;let q=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(F.dk,{ref:t,className:(0,g.cn)("text-sm text-muted-foreground",a),...r})});q.displayName=F.dk.displayName;var K=a(6251),Q=a(4856),G=a(1415),J=a(1124),X=a(9797);function $(e){let{open:t,onOpenChange:a,event:i,isCreating:n,marketAddress:o,selectedDate:c,onSave:d,onDelete:m}=e,[u,h]=(0,r.useState)({title:"",description:"",start_at:"",end_at:"",all_day:!1,location:"",tags:[],visibility:"public"}),[g,p]=(0,r.useState)(""),[v,f]=(0,r.useState)(!1),[y,j]=(0,r.useState)({});(0,r.useEffect)(()=>{if(t){if(i&&!n){let e=new Date(i.start_at),t=new Date(i.end_at);h({title:i.title||"",description:i.description||"",start_at:b(e),end_at:b(t),all_day:i.all_day||!1,location:i.location||"",tags:i.tags||[],visibility:i.visibility||"public"})}else{let e=new Date(c);e.setHours(9,0);let t=new Date(c);t.setHours(11,0),h({title:"",description:"",start_at:b(e),end_at:b(t),all_day:!1,location:o||"",tags:[],visibility:"public"})}}j({}),p("")},[i,n,t,c,o]);let b=e=>{let t=new Date(e.toLocaleString("en-US",{timeZone:"Australia/Brisbane"})),a=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),n=String(t.getMinutes()).padStart(2,"0");return"".concat(a,"-").concat(s,"-").concat(r,"T").concat(i,":").concat(n)},N=e=>e?new Date(new Date(e).getTime()+36e6).toISOString():null,w=()=>{let e={};return u.title.trim()||(e.title="Title is required"),u.start_at||(e.start_at="Start time is required"),u.end_at||(e.end_at="End time is required"),u.start_at&&u.end_at&&new Date(u.start_at)>=new Date(u.end_at)&&(e.end_at="End time must be after start time"),j(e),0===Object.keys(e).length},_=async e=>{if(e.preventDefault(),w()){f(!0);try{let e={title:u.title.trim(),description:u.description.trim()||void 0,start_at:N(u.start_at),end_at:N(u.end_at),all_day:u.all_day,location:u.location.trim()||void 0,tags:u.tags,visibility:u.visibility};await d(e)}finally{f(!1)}}},k=async()=>{i&&await m(i.id)},S=()=>{let e=g.trim().toLowerCase();e&&!u.tags.includes(e)&&(h(t=>({...t,tags:[...t.tags,e]})),p(""))},D=e=>{h(t=>({...t,tags:t.tags.filter(t=>t!==e)}))},C=e=>{h(t=>{if(e){let e=new Date(t.start_at||c),a=new Date(t.start_at||c);return e.setHours(0,0,0,0),a.setHours(23,59,59,999),{...t,all_day:!0,start_at:b(e),end_at:b(a)}}{let e=new Date(t.start_at||c),a=new Date(t.start_at||c);return e.setHours(9,0,0,0),a.setHours(11,0,0,0),{...t,all_day:!1,start_at:b(e),end_at:b(a)}}})};return(0,s.jsx)(I,{open:t,onOpenChange:a,children:(0,s.jsx)(V,{className:"w-full sm:max-w-lg overflow-y-auto",children:(0,s.jsxs)("form",{onSubmit:_,children:[(0,s.jsxs)(R,{children:[(0,s.jsx)(W,{children:n?"Create New Event":"Edit Event"}),(0,s.jsx)(q,{children:n?"Create a new event for this market. All times are in Australia/Brisbane timezone.":"Update event details. All times are in Australia/Brisbane timezone."})]}),(0,s.jsxs)("div",{className:"space-y-6 py-6",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(Z._,{htmlFor:"title",children:["Event Title ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)(M.I,{id:"title",value:u.title,onChange:e=>h(t=>({...t,title:e.target.value})),placeholder:"Enter event title",className:y.title?"border-red-500":""}),y.title&&(0,s.jsx)("p",{className:"text-sm text-red-500",children:y.title})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{id:"all-day",type:"checkbox",checked:u.all_day,onChange:e=>C(e.target.checked),className:"rounded"}),(0,s.jsx)(Z._,{htmlFor:"all-day",children:"All day event"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(Z._,{htmlFor:"start-time",children:["Start Time ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)(M.I,{id:"start-time",type:"datetime-local",value:u.start_at,onChange:e=>h(t=>({...t,start_at:e.target.value})),className:y.start_at?"border-red-500":""}),y.start_at&&(0,s.jsx)("p",{className:"text-sm text-red-500",children:y.start_at})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(Z._,{htmlFor:"end-time",children:["End Time ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)(M.I,{id:"end-time",type:"datetime-local",value:u.end_at,onChange:e=>h(t=>({...t,end_at:e.target.value})),className:y.end_at?"border-red-500":""}),y.end_at&&(0,s.jsx)("p",{className:"text-sm text-red-500",children:y.end_at})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(Z._,{htmlFor:"location",children:[(0,s.jsx)(E.Z,{className:"w-4 h-4 inline mr-1"}),"Location"]}),(0,s.jsx)(M.I,{id:"location",value:u.location,onChange:e=>h(t=>({...t,location:e.target.value})),placeholder:"Event location (optional)"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(Z._,{htmlFor:"description",children:"Description"}),(0,s.jsx)(T.g,{id:"description",value:u.description,onChange:e=>h(t=>({...t,description:e.target.value})),placeholder:"Add event description (optional)",rows:3})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(Z._,{children:[(0,s.jsx)(K.Z,{className:"w-4 h-4 inline mr-1"}),"Tags"]}),u.tags.length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:u.tags.map(e=>(0,s.jsxs)(P.C,{variant:"secondary",className:"cursor-pointer hover:bg-red-100",onClick:()=>D(e),children:[e,(0,s.jsx)(U.Z,{className:"w-3 h-3 ml-1"})]},e))}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(M.I,{value:g,onChange:e=>p(e.target.value),placeholder:"Add a tag",onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),S())}),(0,s.jsx)(l.z,{type:"button",size:"sm",onClick:S,disabled:!g.trim(),children:(0,s.jsx)(x.Z,{className:"w-4 h-4"})})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(Z._,{children:"Visibility"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(l.z,{type:"button",variant:"public"===u.visibility?"default":"outline",size:"sm",onClick:()=>h(e=>({...e,visibility:"public"})),children:[(0,s.jsx)(Q.Z,{className:"w-4 h-4 mr-1"}),"Public"]}),(0,s.jsxs)(l.z,{type:"button",variant:"private"===u.visibility?"default":"outline",size:"sm",onClick:()=>h(e=>({...e,visibility:"private"})),children:[(0,s.jsx)(G.Z,{className:"w-4 h-4 mr-1"}),"Private"]})]})]})]}),(0,s.jsxs)(Y,{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"flex gap-2",children:!n&&(0,s.jsxs)(l.z,{type:"button",variant:"destructive",size:"sm",onClick:k,disabled:v,children:[(0,s.jsx)(J.Z,{className:"w-4 h-4 mr-1"}),"Delete"]})}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(l.z,{type:"button",variant:"outline",onClick:()=>a(!1),disabled:v,children:"Cancel"}),(0,s.jsx)(l.z,{type:"submit",disabled:v,children:v?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Saving..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(X.Z,{className:"w-4 h-4 mr-1"}),n?"Create Event":"Update Event"]})})]})]})]})})})}var ee=a(1250);function et(){let e=(0,i.useParams)(),t=(0,i.useRouter)(),{toast:a}=(0,ee.pm)(),g=e.id,[p,v]=(0,r.useState)(null),[f,y]=(0,r.useState)([]),[j,b]=(0,r.useState)(new Date),[N,w]=(0,r.useState)("month"),[_,k]=(0,r.useState)(null),[S,D]=(0,r.useState)(!1),[C,E]=(0,r.useState)(!1),[z,M]=(0,r.useState)(!0),[Z,T]=(0,r.useState)(null);(0,r.useEffect)(()=>{P()},[g]);let P=async()=>{try{M(!0),T(null);let e=await fetch("/api/markets/".concat(g));if(!e.ok){if(404===e.status)throw Error("Market not found");if(403===e.status)throw Error("You do not have permission to manage this market");throw Error("Failed to load market")}let t=await e.json();v(t),await F(j)}catch(e){console.error("Error loading market and events:",e),T(e.message),e.message.includes("permission")&&a({title:"Access Denied",description:"You don't have permission to manage events for this market.",variant:"destructive"})}finally{M(!1)}},F=async e=>{try{let{from:t,to:a}=O(e,N),s=await fetch("/api/markets/".concat(g,"/events?from=").concat(t,"&to=").concat(a));if(!s.ok)throw Error("Failed to load events");let r=await s.json();y(r.items||[])}catch(e){console.error("Error loading events:",e),a({title:"Error",description:"Failed to load events. Please try again.",variant:"destructive"})}},O=(e,t)=>{let a,s;let r=e.getFullYear(),i=e.getMonth();switch(t){case"month":a=new Date(r,i,1).toISOString(),s=new Date(r,i+1,0,23,59,59).toISOString();break;case"week":let n=new Date(e);n.setDate(e.getDate()-e.getDay()),n.setHours(0,0,0,0);let l=new Date(n);l.setDate(n.getDate()+6),l.setHours(23,59,59,999),a=n.toISOString(),s=l.toISOString();break;case"day":let o=new Date(e);o.setHours(0,0,0,0);let c=new Date(e);c.setHours(23,59,59,999),a=o.toISOString(),s=c.toISOString()}return{from:a,to:s}},U=e=>{let t=new Date(j);if("today"===e)t=new Date;else{let a="next"===e?1:-1;switch(N){case"month":t.setMonth(t.getMonth()+a);break;case"week":t.setDate(t.getDate()+7*a);break;case"day":t.setDate(t.getDate()+a)}}b(t),F(t)},I=e=>{w(e),F(j)},H=e=>{k(null),E(!0),e&&b(e),D(!0)},B=async e=>{try{let t=!!_,s=t?"/api/markets/".concat(g,"/events/").concat(_.id):"/api/markets/".concat(g,"/events"),r=await fetch(s,{method:t?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!r.ok)throw Error("Failed to ".concat(t?"update":"create"," event"));let i=await r.json();t?y(e=>e.map(e=>e.id===i.id?i:e)):y(e=>[...e,i]),a({title:"Success",description:"Event ".concat(t?"updated":"created"," successfully.")}),D(!1)}catch(e){console.error("Error saving event:",e),a({title:"Error",description:"Failed to save event. Please try again.",variant:"destructive"})}},L=async e=>{if(confirm("Are you sure you want to delete this event? This action cannot be undone."))try{if(!(await fetch("/api/markets/".concat(g,"/events/").concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete event");y(t=>t.filter(t=>t.id!==e)),D(!1),a({title:"Success",description:"Event deleted successfully."})}catch(e){console.error("Error deleting event:",e),a({title:"Error",description:"Failed to delete event. Please try again.",variant:"destructive"})}},V=(0,r.useMemo)(()=>{switch(N){case"month":return j.toLocaleDateString("en-AU",{timeZone:"Australia/Brisbane",year:"numeric",month:"long"});case"week":{let{from:e,to:t}=O(j,"week"),a=new Date(e),s=new Date(t);return"".concat(a.toLocaleDateString("en-AU",{timeZone:"Australia/Brisbane",month:"short",day:"numeric"})," - ").concat(s.toLocaleDateString("en-AU",{timeZone:"Australia/Brisbane",month:"short",day:"numeric",year:"numeric"}))}case"day":return j.toLocaleDateString("en-AU",{timeZone:"Australia/Brisbane",weekday:"long",year:"numeric",month:"long",day:"numeric"})}},[j,N]);return z?(0,s.jsx)(h.r,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"h-8 bg-gray-200 rounded animate-pulse"}),(0,s.jsx)("div",{className:"h-96 bg-gray-200 rounded animate-pulse"})]})}):Z?(0,s.jsx)(h.r,{children:(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsxs)("div",{className:"text-red-600 mb-4",children:[(0,s.jsx)(c.Z,{className:"w-12 h-12 mx-auto mb-4"}),(0,s.jsx)("h2",{className:"text-lg font-semibold",children:"Cannot Load Events"}),(0,s.jsx)("p",{className:"text-gray-600",children:Z})]}),(0,s.jsxs)("div",{className:"space-x-4",children:[(0,s.jsx)(l.z,{onClick:()=>t.back(),children:"Go Back"}),(0,s.jsx)(l.z,{variant:"outline",onClick:P,children:"Try Again"})]})]})}):(0,s.jsx)(h.r,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(n.default,{href:"/organizer/markets/".concat(g),children:(0,s.jsxs)(l.z,{variant:"ghost",size:"sm",children:[(0,s.jsx)(d.Z,{className:"w-4 h-4 mr-2"}),"Back to Market"]})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Events"}),(0,s.jsxs)("p",{className:"text-muted-foreground",children:["Manage events for ",null==p?void 0:p.name," â€¢ Australia/Brisbane timezone"]})]})]})}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 p-4 bg-white border rounded-lg",children:[(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)(o.mQ,{value:N,onValueChange:e=>I(e),children:(0,s.jsxs)(o.dr,{children:[(0,s.jsx)(o.SP,{value:"month",children:"Month"}),(0,s.jsx)(o.SP,{value:"week",children:"Week"}),(0,s.jsx)(o.SP,{value:"day",children:"Day"})]})})}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>U("prev"),children:(0,s.jsx)(m.Z,{className:"w-4 h-4"})}),(0,s.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>U("today"),className:"min-w-[80px]",children:"Today"}),(0,s.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>U("next"),children:(0,s.jsx)(u.Z,{className:"w-4 h-4"})}),(0,s.jsx)("span",{className:"text-sm font-medium mx-4 min-w-[200px] text-center",children:V}),(0,s.jsxs)(l.z,{onClick:()=>H(),children:[(0,s.jsx)(x.Z,{className:"w-4 h-4 mr-2"}),"New Event"]})]})]}),(0,s.jsx)("div",{className:"bg-white border rounded-lg overflow-hidden",children:(0,s.jsx)(A,{viewMode:N,selectedDate:j,events:f,onEventClick:e=>{k(e),E(!1),D(!0)},onDateClick:H,onDateChange:b})}),(0,s.jsx)($,{open:S,onOpenChange:D,event:_,isCreating:C,marketAddress:null==p?void 0:p.address,selectedDate:j,onSave:B,onDelete:L})]})})}},4051:function(e,t,a){"use strict";a.d(t,{C:function(){return l}});var s=a(7573);a(7653);var r=a(5517),i=a(5974);let n=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:a,...r}=e;return(0,s.jsx)("div",{className:(0,i.cn)(n({variant:a}),t),...r})}},3608:function(e,t,a){"use strict";a.d(t,{SP:function(){return c},dr:function(){return o},mQ:function(){return l},nU:function(){return d}});var s=a(7573),r=a(7653),i=a(4948),n=a(5974);let l=i.fC,o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(i.aV,{ref:t,className:(0,n.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...r})});o.displayName=i.aV.displayName;let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(i.xz,{ref:t,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...r})});c.displayName=i.xz.displayName;let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(i.VY,{ref:t,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...r})});d.displayName=i.VY.displayName}},function(e){e.O(0,[469,271,944,445,637,936,816,45,293,286,744],function(){return e(e.s=4190)}),_N_E=e.O()}]);